setwd("~/Documents/siste-manual-v2/Hecho 24-11/busquedas/datos")
library(ape)
library(phangorn)
primates <- read.phyDat ("chars2.txt", format="phylip",  type="DNA")
write.nexus.data (primates, file="primates.nex")
matrizDistancia <- dist.dna(as.DNAbin(primates))
arbolUPGMA <- upgma (matrizDistancia)
arbolNJ    <- NJ(matrizDistancia)
plot (arbolUPGMA, main="UPGMA", cex = 0.8)
plot (arbolNJ, "unrooted", main="NJ", cex = 0.5)
arbolRAS <- random.addition(primates,  method="fitch")
plot(arbolRAS,  main="UPGMA",  cex = 0.8)
parsimony(treeUPGMA,  primates)
arbolRAM <- random.addition(primates,  method="fitch")
plot(arbolRAM,  main="UPGMA",  cex = 0.8)
parsimony(arbolUPGMA,  primates)
parsimony(arbolNJ,  primates)
parsimony(arbolRAM, primates)
optParsUPGMA <- optim.parsimony(arbolUPGMA,  primates)
optParsNJ    <- optim.parsimony(arbolNJ,  primates)
optParsRAM   <- optim.parsimony(arbolRAM,  primates)
optParsUPGMA\_SPR <- optim.parsimony(arbolUPGMA,  primates, rearrangements="SPR")
optParsUPGMA_SPR <- optim.parsimony(arbolUPGMA,  primates, rearrangements="SPR")
optParsUPGMA_NNI <- optim.parsimony(arbolUPGMA,  primates, rearrangements="NNI")
pratchet(primates,  start=treeUPGMA,  method="fitch",  maxit=100,  k=5,  trace=1,  all=FALSE, rearrangements="NNI")
pratchet(primates,  start=arbolUPGMA,  method="fitch",  maxit=100,  k=5,  trace=1,  all=FALSE, rearrangements="NNI")
pratchet(primates,  start=arbolUPGMA,  method="fitch",  maxit=100,  k=5,  trace=1,  all=FALSE, rearrangements="SPR")}
pratchet(primates,  start=arbolUPGMA,  method="fitch",  maxit=100,  k=5,  trace=1,  all=FALSE, rearrangements="SPR")
pratchet(primates,  start=optParsUPGMA_NNI,  method="fitch",  maxit=100,  k=5,  trace=1,  all=FALSE, rearrangements="NNI")}
pratchet(primates,  start=optParsUPGMA_NNI,  method="fitch",  maxit=100,  k=5,  trace=1,  all=FALSE, rearrangements="NNI")
pratchet(primates,  start=optParsUPGMA_NNI,  method="fitch",  maxit=100,  k=5,  trace=1,  all=FALSE,  rearrangements="SPR")
pratchet(primates,  start=optParsUPGMA_SPR,  method="fitch",  maxit=100,  k=5,  trace=1,  all=FALSE, rearrangements="NNI")
pratchet(primates,  start=optParsUPGMA_SPR,  method="fitch", maxit=100,  k=5,  trace=1,  all=FALSE, rearrangements="SPR")}
pratchet(primates,  start=optParsUPGMA_SPR,  method="fitch", maxit=100,  k=5,  trace=1,  all=FALSE, rearrangements="SPR")
setwd("~/Documents/siste-manual-v2/Hecho 24-11/Practica03_arboles")
setwd("~/Documents/siste-manual-v2/Hecho 24-11/Practica03_arboles/datos")
arbol <- read.tree("arbol.r.tre")
plot(arbol)
plot.phylo(arbol)
plot(arbol,use.edge.length=FALSE)
arbol$node.label<-arbol$edge.length
plot(arbol,show.node.label=TRUE)
plot(arbol, type="cladogram",main="Arbol 1", edge.col=c("red","blue","cyan"))
MatrizDatos <- read.phyDat("matriz.r.phy")
parsimony(arbol,MatrizDatos)
